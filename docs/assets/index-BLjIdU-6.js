(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();function c(s,e=document.body){const t=e.querySelector(s);if(t)return t;const o=e.querySelectorAll("*");for(const r of o)if(r.shadowRoot){const i=c(s,r.shadowRoot);if(i)return i}return null}const u="torchlit-state",h="data-tour-id",p=10,m={getItem:()=>null,setItem:()=>{}};function g(){try{const s="__torchlit_test__";return localStorage.setItem(s,s),localStorage.removeItem(s),localStorage}catch{return m}}class f{constructor(e={}){this.tours=new Map,this.activeTourId=null,this.currentStepIndex=0,this.listeners=new Set,this.storageKey=e.storageKey??u,this.storage=e.storage??g(),this.targetAttribute=e.targetAttribute??h,this.spotlightPadding=e.spotlightPadding??p,this.persistedState=this.loadState()}loadState(){try{const e=this.storage.getItem(this.storageKey);if(e){const t=JSON.parse(e);return{completed:Array.isArray(t.completed)?t.completed:[],dismissed:Array.isArray(t.dismissed)?t.dismissed:[]}}}catch(e){console.error("[torchlit] Failed to load state:",e)}return{completed:[],dismissed:[]}}saveState(){try{this.storage.setItem(this.storageKey,JSON.stringify(this.persistedState))}catch(e){console.error("[torchlit] Failed to save state:",e)}}register(e){Array.isArray(e)?e.forEach(t=>this.tours.set(t.id,t)):this.tours.set(e.id,e)}getTour(e){return this.tours.get(e)}getAvailableTours(){return Array.from(this.tours.values())}shouldAutoStart(e){const t=this.tours.get(e);return!t||t.trigger!=="first-visit"?!1:!this.persistedState.completed.includes(e)&&!this.persistedState.dismissed.includes(e)}isActive(){return this.activeTourId!==null}start(e){const t=this.tours.get(e);!t||t.steps.length===0||(this.activeTourId=e,this.currentStepIndex=0,this.notify())}nextStep(){if(!this.activeTourId)return;const e=this.tours.get(this.activeTourId);this.currentStepIndex<e.steps.length-1?(this.currentStepIndex++,this.notify()):this.completeTour()}prevStep(){this.activeTourId&&this.currentStepIndex>0&&(this.currentStepIndex--,this.notify())}skipTour(){var o;if(!this.activeTourId)return;const e=this.activeTourId,t=this.tours.get(e);this.persistedState.dismissed.includes(e)||(this.persistedState.dismissed.push(e),this.saveState()),this.activeTourId=null,this.currentStepIndex=0,this.notify(),(o=t==null?void 0:t.onSkip)==null||o.call(t)}completeTour(){var o;if(!this.activeTourId)return;const e=this.activeTourId,t=this.tours.get(e);this.persistedState.completed.includes(e)||(this.persistedState.completed.push(e),this.saveState()),this.activeTourId=null,this.currentStepIndex=0,this.notify(),(o=t==null?void 0:t.onComplete)==null||o.call(t)}getSnapshot(){if(!this.activeTourId)return null;const e=this.tours.get(this.activeTourId);if(!e)return null;const t=e.steps[this.currentStepIndex];if(!t)return null;const o=this.findTarget(t.target),r=(o==null?void 0:o.getBoundingClientRect())??null;return{tourId:this.activeTourId,tourName:e.name,step:t,stepIndex:this.currentStepIndex,totalSteps:e.steps.length,targetRect:r,targetElement:o}}findTarget(e){return c(`[${this.targetAttribute}="${e}"]`,document.body)}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notify(){const e=this.getSnapshot();this.listeners.forEach(t=>t(e))}resetAll(){this.persistedState={completed:[],dismissed:[]},this.activeTourId=null,this.currentStepIndex=0,this.tours.clear(),this.saveState(),this.notify()}}function y(s){return new f(s)}const a=y({storageKey:"torchlit-demo"}),d=document.querySelector("torchlit-overlay");d.service=a;function n(s){document.querySelectorAll(".page").forEach(o=>o.classList.remove("active")),document.querySelectorAll(".nav-item").forEach(o=>o.classList.remove("active"));const e=document.getElementById(`page-${s}`),t=document.querySelector(`.nav-item[data-page="${s}"]`);e&&e.classList.add("active"),t&&t.classList.add("active")}document.querySelectorAll(".nav-item").forEach(s=>{s.addEventListener("click",()=>{n(s.dataset.page)})});d.addEventListener("tour-route-change",s=>{n(s.detail.route)});a.register([{id:"onboarding",name:"Welcome Tour",trigger:"first-visit",steps:[{target:"_none_",title:"Welcome to Torchlit!",message:"This is a quick tour of the demo app. We'll show you the key areas so you can see how guided tours work. Use arrow keys or click Next.",placement:"bottom"},{target:"nav-home",title:"Navigation",message:"The sidebar lets you move between pages. Each page can have its own contextual help tour.",placement:"right"},{target:"home-stats",title:"At-a-Glance Stats",message:"Key metrics are displayed prominently. The spotlight highlights exactly the element you want users to notice.",placement:"bottom"},{target:"home-features",title:"Feature Cards",message:"These cards showcase what makes Torchlit unique. Shadow DOM traversal, framework-agnostic design, tiny bundle size.",placement:"top"},{target:"nav-reports",title:"Reports Page",message:"Tours can switch pages automatically using the route property and beforeShow hooks. Watch — we'll jump to Reports next.",placement:"right"},{target:"reports-chart",title:"Data Visualization",message:"The spotlight followed you to a different page! The tour continued seamlessly across route changes.",placement:"top",beforeShow:()=>n("reports")},{target:"header-help",title:"Need Help?",message:"Click the ? button anytime for contextual help about the current page. You're all set!",placement:"bottom",beforeShow:()=>n("home")}],onComplete:()=>console.log("[demo] Onboarding complete!"),onSkip:()=>console.log("[demo] Onboarding skipped")},{id:"home-help",name:"Home Page Help",trigger:"manual",steps:[{target:"home-stats",title:"Stats Overview",message:"These cards show key metrics about the library: bundle size, dependency count, and framework compatibility.",placement:"bottom"},{target:"home-features",title:"Feature Highlights",message:"Each card describes a key differentiator. Hover them for a subtle lift effect — all CSS, no JS.",placement:"top"},{target:"header-theme",title:"Theme Toggle",message:"Switch between light and dark mode. The tour overlay adapts automatically via CSS custom properties — zero config.",placement:"bottom"}]},{id:"reports-help",name:"Reports Help",trigger:"manual",steps:[{target:"reports-search",title:"Search Reports",message:"Filter reports by keyword. Results update in real-time.",placement:"bottom"},{target:"reports-chart",title:"Chart Area",message:"Interactive charts render here. Click data points for details.",placement:"top"}]},{id:"settings-help",name:"Settings Help",trigger:"manual",steps:[{target:"settings-general",title:"General Settings",message:"Configure language, timezone, and display preferences here.",placement:"bottom"},{target:"settings-notifications",title:"Notification Preferences",message:"Control email alerts, push notifications, and digest frequency.",placement:"bottom"}]},{id:"profile-help",name:"Profile Help",trigger:"manual",steps:[{target:"profile-card",title:"Your Profile",message:"View and edit your account details, avatar, and contact info.",placement:"right"}]}]);const S={home:"home-help",reports:"reports-help",settings:"settings-help",profile:"profile-help"};document.getElementById("btn-help").addEventListener("click",()=>{var t;const s=((t=document.querySelector(".nav-item.active"))==null?void 0:t.dataset.page)||"home",e=S[s];e&&a.start(e)});document.getElementById("btn-theme").addEventListener("click",()=>{document.documentElement.classList.toggle("dark")});document.getElementById("btn-reset").addEventListener("click",()=>{a.resetAll(),location.reload()});a.shouldAutoStart("onboarding")&&setTimeout(()=>a.start("onboarding"),800);
