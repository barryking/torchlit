<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Torchlit — Multi-Page Tour Example</title>
  <style>
    body { font-family: system-ui, sans-serif; margin: 0; }
    .layout { display: grid; grid-template-columns: 200px 1fr; min-height: 100vh; }
    .sidebar { background: #1e293b; color: white; padding: 1.5rem 1rem; }
    .sidebar h2 { font-size: 0.875rem; margin-bottom: 1rem; opacity: 0.7; text-transform: uppercase; letter-spacing: 0.05em; }
    .sidebar button { display: block; width: 100%; text-align: left; padding: 0.5rem 0.75rem; margin-bottom: 0.25rem; background: none; border: none; color: #94a3b8; border-radius: 0.375rem; cursor: pointer; font-size: 0.875rem; font-family: inherit; }
    .sidebar button:hover { background: rgba(255,255,255,0.1); color: white; }
    .sidebar button.active { background: #F26122; color: white; }
    .main { padding: 2rem; }
    .main h1 { margin-bottom: 0.5rem; }
    .main p { color: #6b7280; margin-bottom: 1.5rem; }
    .page { display: none; }
    .page.active { display: block; }
    .card { background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1.5rem; margin-bottom: 1rem; }
    .actions { margin-top: 1rem; }
    .actions button { padding: 0.5rem 1rem; background: #F26122; color: white; border: none; border-radius: 0.375rem; cursor: pointer; font-weight: 500; }
    .actions button:hover { background: #BF4A1A; }
  </style>
</head>
<body>
  <div class="layout">
    <nav class="sidebar">
      <h2>Navigation</h2>
      <button class="active" data-page="dashboard" data-tour-id="nav-dashboard">Dashboard</button>
      <button data-page="analytics" data-tour-id="nav-analytics">Analytics</button>
      <button data-page="settings" data-tour-id="nav-settings">Settings</button>
    </nav>

    <div class="main">
      <div class="page active" id="page-dashboard">
        <h1>Dashboard</h1>
        <p>Your main dashboard overview.</p>
        <div class="card" data-tour-id="dashboard-stats">
          <strong>Stats:</strong> 142 users, 89 sessions today
        </div>
        <div class="actions">
          <button id="start-tour">Start Tour</button>
        </div>
      </div>

      <div class="page" id="page-analytics">
        <h1>Analytics</h1>
        <p>Detailed analytics and reporting.</p>
        <div class="card" data-tour-id="analytics-chart">
          Chart area — your data visualizations go here
        </div>
      </div>

      <div class="page" id="page-settings">
        <h1>Settings</h1>
        <p>Configure your preferences.</p>
        <div class="card" data-tour-id="settings-general">
          General settings panel
        </div>
      </div>
    </div>
  </div>

  <torchlit-overlay></torchlit-overlay>

  <script type="module">
    import { createTourService, TorchlitOverlay } from '../src/index.ts';

    if (!customElements.get('torchlit-overlay')) {
      customElements.define('torchlit-overlay', TorchlitOverlay);
    }

    const tours = createTourService({ storageKey: 'multi-page-example' });
    const overlay = document.querySelector('torchlit-overlay');
    overlay.service = tours;

    // Page switching
    function switchPage(name) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.querySelectorAll('.sidebar button').forEach(b => b.classList.remove('active'));
      document.getElementById(`page-${name}`)?.classList.add('active');
      document.querySelector(`[data-page="${name}"]`)?.classList.add('active');
    }

    document.querySelectorAll('.sidebar button').forEach(btn => {
      btn.addEventListener('click', () => switchPage(btn.dataset.page));
    });

    // Handle tour route changes
    overlay.addEventListener('tour-route-change', (e) => {
      switchPage(e.detail.route);
    });

    // Register a multi-page tour
    tours.register({
      id: 'full-tour',
      name: 'Full App Tour',
      trigger: 'manual',
      steps: [
        {
          target: '_none_',
          title: 'Multi-Page Tour',
          message: 'This tour demonstrates navigation across multiple pages using route and beforeShow.',
          placement: 'bottom',
        },
        {
          target: 'dashboard-stats',
          title: 'Dashboard Stats',
          message: 'Key metrics on the dashboard. Next we\'ll jump to Analytics.',
          placement: 'bottom',
        },
        {
          target: 'analytics-chart',
          title: 'Analytics Charts',
          message: 'The tour switched pages! The spotlight followed seamlessly.',
          placement: 'top',
          route: 'analytics',
          beforeShow: () => switchPage('analytics'),
        },
        {
          target: 'nav-settings',
          title: 'Settings',
          message: 'One more page switch — let\'s check Settings.',
          placement: 'right',
        },
        {
          target: 'settings-general',
          title: 'General Settings',
          message: 'Tours can span any number of views. That\'s it!',
          placement: 'top',
          route: 'settings',
          beforeShow: () => switchPage('settings'),
        },
      ],
      onComplete: () => {
        switchPage('dashboard');
        console.log('Multi-page tour complete!');
      },
    });

    document.getElementById('start-tour').addEventListener('click', () => {
      tours.start('full-tour');
    });
  </script>
</body>
</html>
